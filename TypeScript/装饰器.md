# 装饰器：

装饰器是一种特殊类型的声明，它能够被附加到类声明、方法、属性或参数上，可以修改类的行为。

通俗来说，装饰器就是一个方法，可以注入到类、方法、属性、参数上来扩展类、方法、属性、参数的功能。

常见的装饰器有：类装饰器、方法装饰器、属性装饰器、参数装饰器

装饰器的写法：普通装饰器（无法传参）、装饰器工厂（可传参）

装饰器是过去几年中js最大成就之一，已是ES7的标准特性之一

## 类装饰器：

类装饰器在声明之前被声明（紧靠着类声明）。类装饰器应用于类构造函数，可以在不更改类的定义的情况下动态地监视，修改或替换类定义。传入一个参数

### 普通装饰器：

```
function logClass(params:any){
    console.log(params);
    params.prototype.apiUrl = 'xxxxx';
    params.prototype.run = function(){
        console.log('run');

    }
}

@logClass
class HttpClient{
    constructor(){

    }
    getData(){

    }
}

var http:any = new HttpClient();
console.log(http.apiUrl);
http.run();
```

### 装饰器工厂：

```
function logClass(params:string){
    return function(target:any){
        console.log(target);

        console.log(params);

        target.prototype.apiUrl = params;

    }
}

@logClass('hahaha')
class HttpClient{
    constructor(){

    }
    getData(){

    }
}

var http:any = new HttpClient();
console.log(http.apiUrl);
```

例子：

重载构造函数

类装饰器表达式会在运行时当作函数被调用，类的构造函数作为其唯一标识符

如果类装饰器返回一个值，它会使用提供的构造函数来替换类的声明

```
function logClass(target:any){
    console.log(target);
   return class extends target{
       apiUrl:any = '我是修改后的apiUrl';
       getData(){
           console.log(this.apiUrl + '(已变更)');

       }
   }
}

@logClass
class HttpClient{
    public apiUrl:string | undefined;
    constructor(){
        this.apiUrl = '我是构造函数中的apiUrl'
    }
    getData(){
        console.log(this.apiUrl);

    }
}
```

## 属性装饰器：

属性装饰器表达式会在运行时当作函数被调用，需要传入两个参数

    1.对于静态成员来说是类的构造函数，对于实例成员是类的原型对象

    2.成员的名字。

```
function logClass(params:string){
    return function(tarfet:any){

    }
}
function logProperty(params:any){
    return function(target:any,attr:any){
        console.log(target);
        console.log(attr);
        target[attr] = params /* target在这里相当于target.prototype*/
    }
}


@logClass('xxx')
class HttpClient{
    @logProperty('aaaaaa')
    public url:any | undefined;
    constructor(){

    }
    getData(){
        console.log(this.url);
        
    }
}

var http = new HttpClient();
http.getData();
```



